{
    "$schema": "http://json-schema.org/draft-03/schema",
    "type": "object" ,
    "title": "Kronos Schedule Format",
    "description": "The Kronos Schedule Format (KSF) is a standardised interchange format for output scheduling and modelling data from Kronos",
    "additionalProperties": false,
    "properties": {
        "version" : {
            "required": true,
            "type": "number",
            "enum": [%(kronos-version)s],
            "description": "Version number of the KSF format"
        },
        "tag": {
            "required": true,
            "enum": ["%(kronos-magic)s"],
            "description": "Magic value to help test validity of KSF file"
        },
        "created": {
            "required": true,
            "type": "string",
            "format": "date-time",
            "description": "A timestamp for creation of the KSF file"
        },
        "uid": {
            "required": false,
            "type": "integer",
            "description": "The UID of the user who created this file"
        },

        "jobs": {
            "required": true,
            "type": "array",
            "description": "Description of synthetic applications",
            "items": {
                "type": "object",
                "properties": {
                    "metadata": {
                        "type": "object",
                        "properties": {
                            "job_name":{
                                "type": "string",
                                "description": "job name"
                            },
                            "num_procs":{
                                "type": "number",
                                "description": "number of processes that the job will run on"
                            },
                            "start_delay":{
                                "type": "number",
                                "description": "job start delay (in sec) relative to the first job"
                            }
                        }
                    },
                    "frames": {
                        "type": "array",
                        "items": {
                            "oneOf": [
                                {
                                    "type": "object",
                                    "description": "kernel to execute CPU instructions",
                                    "properties": {
                                        "name": {
                                            "type": "string",
                                            "required": true,
                                            "description": "type of kernel",
                                            "enum": ["cpu"]
                                        },
                                        "flops": {
                                            "type": "number",
                                            "required": true,
                                            "description": "Number of flops to execute"
                                        }
                                    }
                                },
                                {
                                    "type": "object",
                                    "description": "kernel to execute MPI instructions",
                                    "properties": {
                                        "name": {
                                            "type": "string",
                                            "required": true,
                                            "description": "type of kernel",
                                            "enum": ["mpi"]
                                        },
                                        "kb_collective": {
                                            "type": "number",
                                            "required": true,
                                            "description": "Number of Kb for collective MPI operations"
                                        },
                                        "kb_pairwise": {
                                            "type": "number",
                                            "required": true,
                                            "description": "Number of Kb for p2p MPI operations"
                                        },
                                        "n_collective": {
                                            "type": "integer",
                                            "required": true,
                                            "description": "Number of collective MPI operations"
                                        },
                                        "n_pairwise": {
                                            "type": "integer",
                                            "required": true,
                                            "description": "Number of p2p MPI operations"
                                        }
                                    }
                                },
                                {
                                    "type": "object",
                                    "description": "kernel to execute IO-read instructions",
                                    "properties": {
                                        "name": {
                                            "type": "string",
                                            "required": true,
                                            "description": "type of kernel",
                                            "enum": ["file-read"]
                                        },
                                        "kb_read": {
                                            "type": "number",
                                            "required": true,
                                            "description": "Number of Kb to read"
                                        },
                                        "mmap": {
                                            "type": "boolean",
                                            "required": true,
                                            "description": "Whether or not read from mmap files"
                                        },
                                        "n_read": {
                                            "type": "integer",
                                            "required": true,
                                            "description": "Number of read"
                                        }
                                    }
                                },
                                {
                                    "type": "object",
                                    "description": "kernel to execute IO-write instructions",
                                    "properties": {
                                        "name": {
                                            "type": "string",
                                            "required": true,
                                            "description": "type of kernel",
                                            "enum": ["file-write"]
                                        },
                                        "kb_write": {
                                            "type": "number",
                                            "required": true,
                                            "description": "Number of Kb to write"
                                        },
                                        "mmap": {
                                            "type": "boolean",
                                            "required": true,
                                            "description": "Whether or not write to mmap files"
                                        },
                                        "n_write": {
                                            "type": "integer",
                                            "required": true,
                                            "description": "Number of writes"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                }

            }
        },
        "tuning_factors": {
            "required": false,
            "type": "object",
            "description": "Description of synthetic applications",
            "patternProperties": {
                "(n_write|n_read|kb_write|kb_read|n_pairwise|kb_pairwise|n_collective|kb_collective|flops)": {
                    "type": "number",
                    "description": "Scaling factors for each job-metric"
                }
            }
        },
        "unscaled_metrics_sums": {
            "required": false,
            "type": "object",
            "description": "Description of synthetic applications",
            "patternProperties": {
                "(n_write|n_read|kb_write|kb_read|n_pairwise|kb_pairwise|n_collective|kb_collective|flops)": {
                    "type": "number",
                    "description": "Unscaled sums of job-metrics"
                }
            }
        }

    }
}