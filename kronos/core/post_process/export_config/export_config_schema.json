{
  "$schema": "http://json-schema.org/draft-04/schema",
  "type": "object",
  "title": "Kronos post-processing configuration file format",
  "description": "The post-processing configuration file format controls the post-processing of Kronos runs",
  "additionalProperties": false,
  "properties": {
    "verbose": {
      "type": "boolean",
      "description": "Verbose flag"
    },
    "experiment_list": {
      "type": "array",
      "description": "Tags of simulation list (used to label plots and/or tabular data)",
      "items": {
        "type": "string"
      }
    },
    "experiment_paths": {
      "type": "array",
      "description": "Paths of simulations (path containing the job-<jobID> sub-folders. They corresponds to the experiment_list tags)",
      "items": {
        "type": "string"
      }
    },
    "output_path": {
      "type": "string",
      "description": "Path where the output will be exported into"
    },
    "n_procs_node": {
      "type": "integer",
      "description": "N procs per node used to run the cases (TODO: this info needs to be removed..)"
    },
    "job_classes": {
      "type": "object",
      "description": "List of classes that jobs will be grouped into for the post-processing"
    },
    "exports": {
      "type": "array",
      "description": "List of exports to do with the data collected from the set of simulations",
      "items": {
        "type": "object",
        "oneOf": [
          {
            "type": "object",
            "description": "Export tabulated data",
            "properties":{
              "type":{
                "type":"string",
                "description": "Export identification string",
                "enum": ["rates_table"]
              },
              "format":{
                "type": "string",
                "description": "Specific format which tabulated data will be written into",
                "enum": ["csv"]
              }
            },
            "required": ["type"]
          },

          {
            "type": "object",
            "description": "Export plots",
            "properties":{
              "type":{
                "type":"string",
                "description": "Export identification string",
                "enum": ["rates_plot"]
              },
              "format":{
                "type": "string",
                "description": "Specific format which tabulated data will be written into",
                "enum": ["png"]
              },
              "y_lims":{
                "type": "array",
                "description": "Y-limits of the axis specified by user"
              }
            },
            "required": ["type"]
          },

          {
            "type": "object",
            "description": "Export plots of time-series",
            "properties":{
              "type":{
                "type":"string",
                "description": "Export identification string",
                "enum": ["time_series_metrics"]
              },
              "format":{
                "type": "string",
                "description": "Specific format which tabulated data will be written into",
                "enum": ["png"]
              },

              "lines": {
                "type": "object",
                "description": "Options for plot lines (each line is a specific metric)",
                "patternProperties": {
                  "(n_write|n_read|kb_write|kb_read|n_pairwise|kb_pairwise|n_collective|kb_collective|flops)": {
                    "type": "object",
                    "patternProperties": {
                      "(x_lims|y_lims)": {
                        "type": "array",
                        "description": "x_lims and y_lims",
                        "items": {
                            "type": "number"
                        }
                      }
                    },
                    "description": "Option for line plots"
                  }
                }
              }
            },
            "required": ["type", "lines"]
          },

          {
            "type": "object",
            "description": "Export plots of time-series of jobs, nodes, processes",
            "properties":{
              "type":{
                "type":"string",
                "description": "Export identification string",
                "enum": ["time_series_jobs_nodes_procs"]
              },
              "format":{
                "type": "string",
                "description": "Specific format which tabulated data will be written into",
                "enum": ["png"]
              },

              "lines": {
                "type": "object",
                "description": "Options for plot lines (each line is a specific metric)",
                "patternProperties": {
                  "(jobs|procs|nodes)": {
                    "type": "object",
                    "patternProperties": {
                      "(x_lims|y_lims)": {
                        "type": "array",
                        "description": "x_lims and y_lims",
                        "items": {
                            "type": "number"
                        }
                      }
                    },
                    "description": "Option for line plots (x_lims and y_lims)"
                  }
                }
              }
            },
            "required": ["type", "lines"]
          },

          {
            "type": "object",
            "description": "Export plots of time-series of io written (total, rates and wiriting processes)",
            "properties":{
              "type":{
                "type":"string",
                "description": "Export identification string",
                "enum": ["time_series_io_rates"]
              },
              "format":{
                "type": "string",
                "description": "Specific format which tabulated data will be written into",
                "enum": ["png"]
              },

              "lines": {
                "type": "object",
                "description": "Options for plot lines (each line is a specific metric)",
                "patternProperties": {
                  "(kb_written|kb_written_sec|writing_processes)": {
                    "type": "object",
                    "patternProperties": {
                      "(x_lims|y_lims)": {
                        "type": "array",
                        "description": "x_lims and y_lims",
                        "items": {
                            "type": "number"
                        }
                      }
                    },
                    "description": "option for line plots (x_lims and y_lims)"
                  }
                }
              }
            },
            "required": ["type", "lines"]
          }

        ]
      }
    }
  }
}